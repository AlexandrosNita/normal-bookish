CREATE TABLE Book (
	ID INTEGER PRIMARY KEY,
	TITLE VARCHAR(255),
	AUTHOR VARCHAR(255),
	ISBN VARCHAR(255),
);

CREATE TABLE BookCopy (
	ID_COPY INTEGER PRIMARY KEY,
	ID_BOOK INTEGER REFERENCES Book(ID)
);

CREATE TABLE LibraryUser (
	ID INTEGER PRIMARY KEY,
	NAME VARCHAR(255)
);

CREATE TABLE Rental (
	ID_USER INTEGER REFERENCES LibraryUser(ID),
	ID_BOOK_COPY INTEGER REFERENCES BookCopy(ID_COPY),
	START_RENTAL_DATE DATE NOT NULL,
	END_RENTAL_DATE DATE NOT NULL,
	CONSTRAINT PRIMARY_KEY PRIMARY KEY (ID_USER, ID_BOOK_COPY),
	CONSTRAINT END_GREATER_START CHECK (END_RENTAL_DATE > START_RENTAL_DATE)
);

INSERT INTO Book VALUES (1, 'Dracula', 'Bram Stocker', '978-0141439846');
INSERT INTO Book VALUES (2, 'A Storm of Swords', 'George R. R. Martin', '978-0593158951');
INSERT INTO Book VALUES (3, 'Crime and Punishment', 'Fyodor Destoyevky', '978-0140449136');

SELECT * FROM Book;

INSERT INTO BookCopy VALUES (1, 1);
INSERT INTO BookCopy VALUES (2, 1);
INSERT INTO BookCopy VALUES (3, 1);
INSERT INTO BookCopy VALUES (4, 1);
INSERT INTO BookCopy VALUES (5, 2);
INSERT INTO BookCopy VALUES (6, 2);
INSERT INTO BookCopy VALUES (7, 3);
INSERT INTO BookCopy VALUES (8, 3);
INSERT INTO BookCopy VALUES (9, 3);

SELECT * FROM BookCopy;

INSERT INTO LibraryUser VALUES (1, 'John Ion Barbu');
INSERT INTO LibraryUser VALUES (2, 'Cosmin Glod');
INSERT INTO LibraryUser VALUES (3, 'Alexandru Cretu');
INSERT INTO LibraryUser VALUES (4, 'Maria Popa');

SELECT * FROM LibraryUser;

INSERT INTO Rental VALUES (1, 1, '2025/03/03', '2025/04/04');
INSERT INTO Rental VALUES (4, 3, '2025/02/17', '2025/03/25');
INSERT INTO Rental VALUES (2, 2, '2025/06/30', '2025/07/25');
INSERT INTO Rental VALUES (2, 2, '2025/03/03', '2025/01/01');

SELECT * FROM Rental;